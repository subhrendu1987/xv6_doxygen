\hypertarget{x86_8h_source}{}\doxysection{x86.\+h}
\mbox{\hyperlink{x86_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00001}00001 \textcolor{comment}{// Routines to let C code use special x86 instructions.}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00003}00003 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{types_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00004}00004 inb(\mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} port)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00005}00005 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00006}00006   \mbox{\hyperlink{types_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}} \mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00008}00008   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}in \%1,\%0"{}} : \textcolor{stringliteral}{"{}=a"{}} (\mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}) : \textcolor{stringliteral}{"{}d"{}} (port));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00009}00009   \textcolor{keywordflow}{return} \mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00010}00010 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00012}00012 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00013}00013 insl(\textcolor{keywordtype}{int} port, \textcolor{keywordtype}{void} *addr, \textcolor{keywordtype}{int} cnt)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00014}00014 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00015}00015   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}cld; rep insl"{}} :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00016}00016                \textcolor{stringliteral}{"{}=D"{}} (addr), \textcolor{stringliteral}{"{}=c"{}} (cnt) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00017}00017                \textcolor{stringliteral}{"{}d"{}} (port), \textcolor{stringliteral}{"{}0"{}} (addr), \textcolor{stringliteral}{"{}1"{}} (cnt) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00018}00018                \textcolor{stringliteral}{"{}memory"{}}, \textcolor{stringliteral}{"{}cc"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00019}00019 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00021}00021 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00022}00022 outb(\mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} port, \mbox{\hyperlink{types_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}} \mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}})}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00023}00023 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00024}00024   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}out \%0,\%1"{}} : : \textcolor{stringliteral}{"{}a"{}} (\mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}), \textcolor{stringliteral}{"{}d"{}} (port));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00025}00025 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00027}00027 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00028}00028 outw(\mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} port, \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}})}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00029}00029 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00030}00030   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}out \%0,\%1"{}} : : \textcolor{stringliteral}{"{}a"{}} (\mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}), \textcolor{stringliteral}{"{}d"{}} (port));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00031}00031 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00033}00033 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00034}00034 outsl(\textcolor{keywordtype}{int} port, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *addr, \textcolor{keywordtype}{int} cnt)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00035}00035 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00036}00036   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}cld; rep outsl"{}} :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00037}00037                \textcolor{stringliteral}{"{}=S"{}} (addr), \textcolor{stringliteral}{"{}=c"{}} (cnt) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00038}00038                \textcolor{stringliteral}{"{}d"{}} (port), \textcolor{stringliteral}{"{}0"{}} (addr), \textcolor{stringliteral}{"{}1"{}} (cnt) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00039}00039                \textcolor{stringliteral}{"{}cc"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00040}00040 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00042}00042 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00043}00043 stosb(\textcolor{keywordtype}{void} *addr, \textcolor{keywordtype}{int} \mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}, \textcolor{keywordtype}{int} cnt)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00044}00044 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00045}00045   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}cld; rep stosb"{}} :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00046}00046                \textcolor{stringliteral}{"{}=D"{}} (addr), \textcolor{stringliteral}{"{}=c"{}} (cnt) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00047}00047                \textcolor{stringliteral}{"{}0"{}} (addr), \textcolor{stringliteral}{"{}1"{}} (cnt), \textcolor{stringliteral}{"{}a"{}} (\mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00048}00048                \textcolor{stringliteral}{"{}memory"{}}, \textcolor{stringliteral}{"{}cc"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00049}00049 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00051}00051 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00052}00052 stosl(\textcolor{keywordtype}{void} *addr, \textcolor{keywordtype}{int} \mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}, \textcolor{keywordtype}{int} cnt)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00053}00053 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00054}00054   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}cld; rep stosl"{}} :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00055}00055                \textcolor{stringliteral}{"{}=D"{}} (addr), \textcolor{stringliteral}{"{}=c"{}} (cnt) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00056}00056                \textcolor{stringliteral}{"{}0"{}} (addr), \textcolor{stringliteral}{"{}1"{}} (cnt), \textcolor{stringliteral}{"{}a"{}} (\mbox{\hyperlink{vm_8c_a923b2158227405b9f7a6eceb6c7104c8}{data}}) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00057}00057                \textcolor{stringliteral}{"{}memory"{}}, \textcolor{stringliteral}{"{}cc"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00058}00058 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00060}00060 \textcolor{keyword}{struct }\mbox{\hyperlink{structsegdesc}{segdesc}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00062}00062 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00063}00063 lgdt(\textcolor{keyword}{struct} \mbox{\hyperlink{structsegdesc}{segdesc}} *\mbox{\hyperlink{structsegdesc_a322a34a84a3815d35ebb3aa50c5a55e2}{p}}, \textcolor{keywordtype}{int} size)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00064}00064 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00065}00065   \textcolor{keyword}{volatile} \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} pd[3];}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00067}00067   pd[0] = size-\/1;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00068}00068   pd[1] = (\mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}})\mbox{\hyperlink{structsegdesc_a322a34a84a3815d35ebb3aa50c5a55e2}{p}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00069}00069   pd[2] = (\mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}})\mbox{\hyperlink{structsegdesc_a322a34a84a3815d35ebb3aa50c5a55e2}{p}} >> 16;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00071}00071   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}lgdt (\%0)"{}} : : \textcolor{stringliteral}{"{}r"{}} (pd));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00072}00072 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00074}00074 \textcolor{keyword}{struct }\mbox{\hyperlink{structgatedesc}{gatedesc}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00076}00076 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00077}00077 lidt(\textcolor{keyword}{struct} \mbox{\hyperlink{structgatedesc}{gatedesc}} *\mbox{\hyperlink{structgatedesc_a5f754b650dc96be286cbc74e69da6a81}{p}}, \textcolor{keywordtype}{int} size)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00078}00078 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00079}00079   \textcolor{keyword}{volatile} \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} pd[3];}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00081}00081   pd[0] = size-\/1;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00082}00082   pd[1] = (\mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}})\mbox{\hyperlink{structgatedesc_a5f754b650dc96be286cbc74e69da6a81}{p}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00083}00083   pd[2] = (\mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}})\mbox{\hyperlink{structgatedesc_a5f754b650dc96be286cbc74e69da6a81}{p}} >> 16;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00085}00085   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}lidt (\%0)"{}} : : \textcolor{stringliteral}{"{}r"{}} (pd));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00086}00086 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00088}00088 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00089}00089 ltr(\mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} sel)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00090}00090 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00091}00091   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}ltr \%0"{}} : : \textcolor{stringliteral}{"{}r"{}} (sel));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00092}00092 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00094}00094 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00095}00095 readeflags(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00096}00096 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00097}00097   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} eflags;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00098}00098   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}pushfl; popl \%0"{}} : \textcolor{stringliteral}{"{}=r"{}} (eflags));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00099}00099   \textcolor{keywordflow}{return} eflags;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00100}00100 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00102}00102 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00103}00103 loadgs(\mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} v)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00104}00104 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00105}00105   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}movw \%0, \%\%gs"{}} : : \textcolor{stringliteral}{"{}r"{}} (v));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00106}00106 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00108}00108 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00109}00109 cli(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00110}00110 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00111}00111   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}cli"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00112}00112 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00114}00114 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00115}00115 sti(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00116}00116 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00117}00117   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}sti"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00118}00118 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00119}00119 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00120}00120 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00121}00121 xchg(\textcolor{keyword}{volatile} \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} *addr, \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} newval)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00122}00122 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00123}00123   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} result;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00125}00125   \textcolor{comment}{// The + in "{}+m"{} denotes a read-\/modify-\/write operand.}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00126}00126   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}lock; xchgl \%0, \%1"{}} :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00127}00127                \textcolor{stringliteral}{"{}+m"{}} (*addr), \textcolor{stringliteral}{"{}=a"{}} (result) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00128}00128                \textcolor{stringliteral}{"{}1"{}} (newval) :}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00129}00129                \textcolor{stringliteral}{"{}cc"{}});}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00130}00130   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00131}00131 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00132}00132 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00133}00133 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00134}00134 rcr2(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00135}00135 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00136}00136   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} val;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00137}00137   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}movl \%\%cr2,\%0"{}} : \textcolor{stringliteral}{"{}=r"{}} (val));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00138}00138   \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00139}00139 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00141}00141 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00142}00142 lcr3(\mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} val)}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00143}00143 \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00144}00144   \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}movl \%0,\%\%cr3"{}} : : \textcolor{stringliteral}{"{}r"{}} (val));}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00145}00145 \}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00147}00147 \textcolor{comment}{//PAGEBREAK: 36}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00148}00148 \textcolor{comment}{// Layout of the trap frame built on the stack by the}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00149}00149 \textcolor{comment}{// hardware and by trapasm.S, and passed to trap().}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00150}\mbox{\hyperlink{structtrapframe}{00150}} \textcolor{keyword}{struct }\mbox{\hyperlink{structtrapframe}{trapframe}} \{}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00151}00151   \textcolor{comment}{// registers as pushed by pusha}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00152}\mbox{\hyperlink{structtrapframe_ad20959553b558987a0d475b6367c87d0}{00152}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_ad20959553b558987a0d475b6367c87d0}{edi}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00153}\mbox{\hyperlink{structtrapframe_a11cbc20a968f2ce7a9b71590a709bb46}{00153}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_a11cbc20a968f2ce7a9b71590a709bb46}{esi}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00154}\mbox{\hyperlink{structtrapframe_a258f414f983f95f6799372d548fbd6d3}{00154}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_a258f414f983f95f6799372d548fbd6d3}{ebp}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00155}\mbox{\hyperlink{structtrapframe_a8466e7bcbbbe2d19fbe7f4fe0daa29fb}{00155}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_a8466e7bcbbbe2d19fbe7f4fe0daa29fb}{oesp}};      \textcolor{comment}{// useless \& ignored}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00156}\mbox{\hyperlink{structtrapframe_a0f93026966ea52a69a94870fb394ba04}{00156}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_a0f93026966ea52a69a94870fb394ba04}{ebx}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00157}\mbox{\hyperlink{structtrapframe_a62585fbda8434a03de564611b89c02ad}{00157}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_a62585fbda8434a03de564611b89c02ad}{edx}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00158}\mbox{\hyperlink{structtrapframe_ad42fe2bbc83c7fe778f0127ac038efa3}{00158}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_ad42fe2bbc83c7fe778f0127ac038efa3}{ecx}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00159}\mbox{\hyperlink{structtrapframe_ab1dd3a10936b61129d7395c3a21bc2fe}{00159}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_ab1dd3a10936b61129d7395c3a21bc2fe}{eax}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00161}00161   \textcolor{comment}{// rest of trap frame}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00162}\mbox{\hyperlink{structtrapframe_a3df62e3ed00405cbaaa4d72902c617da}{00162}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a3df62e3ed00405cbaaa4d72902c617da}{gs}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00163}\mbox{\hyperlink{structtrapframe_a84a5fbe43d7f11df983d97c80aabb454}{00163}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a84a5fbe43d7f11df983d97c80aabb454}{padding1}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00164}\mbox{\hyperlink{structtrapframe_a4791a272cca7213d324e59db2d9d0b71}{00164}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a4791a272cca7213d324e59db2d9d0b71}{fs}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00165}\mbox{\hyperlink{structtrapframe_a63737765c58491a8604ef180a3864ad0}{00165}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a63737765c58491a8604ef180a3864ad0}{padding2}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00166}\mbox{\hyperlink{structtrapframe_ab974b358098da0aaa5897c32827a038d}{00166}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_ab974b358098da0aaa5897c32827a038d}{es}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00167}\mbox{\hyperlink{structtrapframe_acd8a8fee013b35212fab787b645f8dd9}{00167}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_acd8a8fee013b35212fab787b645f8dd9}{padding3}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00168}\mbox{\hyperlink{structtrapframe_a421be1ec9ad2a55f1d1adeac9b0b89c3}{00168}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a421be1ec9ad2a55f1d1adeac9b0b89c3}{ds}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00169}\mbox{\hyperlink{structtrapframe_aef4bc72b31fb4a0cf6b32782b40a7e2f}{00169}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_aef4bc72b31fb4a0cf6b32782b40a7e2f}{padding4}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00170}\mbox{\hyperlink{structtrapframe_abc7f81b0a6a91d13e9fefe171b0a7d12}{00170}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_abc7f81b0a6a91d13e9fefe171b0a7d12}{trapno}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00172}00172   \textcolor{comment}{// below here defined by x86 hardware}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00173}\mbox{\hyperlink{structtrapframe_acfb2346e6184b0d2438960b4f2a67e4f}{00173}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_acfb2346e6184b0d2438960b4f2a67e4f}{err}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00174}\mbox{\hyperlink{structtrapframe_a886a5973a537894e3a95435f38767d5c}{00174}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_a886a5973a537894e3a95435f38767d5c}{eip}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00175}\mbox{\hyperlink{structtrapframe_a61261f63223a73e25be79fcc8c625265}{00175}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a61261f63223a73e25be79fcc8c625265}{cs}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00176}\mbox{\hyperlink{structtrapframe_a5715f786df145b0bf6faf3aa3304f05f}{00176}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a5715f786df145b0bf6faf3aa3304f05f}{padding5}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00177}\mbox{\hyperlink{structtrapframe_ae6b3005ad34416546603ab18dbb4a644}{00177}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_ae6b3005ad34416546603ab18dbb4a644}{eflags}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00178}00178 }
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00179}00179   \textcolor{comment}{// below here only when crossing rings, such as from user to kernel}}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00180}\mbox{\hyperlink{structtrapframe_acd319e2dbd720d217c10f8fb620d73e2}{00180}}   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} \mbox{\hyperlink{structtrapframe_acd319e2dbd720d217c10f8fb620d73e2}{esp}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00181}\mbox{\hyperlink{structtrapframe_aa9c9b52b242d4f42fe4252e26b655bf6}{00181}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_aa9c9b52b242d4f42fe4252e26b655bf6}{ss}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00182}\mbox{\hyperlink{structtrapframe_a1c079b271df9fdd3502bfe9e00888dfa}{00182}}   \mbox{\hyperlink{types_8h_ab95f123a6c9bcfee6a343170ef8c5f69}{ushort}} \mbox{\hyperlink{structtrapframe_a1c079b271df9fdd3502bfe9e00888dfa}{padding6}};}
\DoxyCodeLine{\Hypertarget{x86_8h_source_l00183}00183 \};}

\end{DoxyCode}
