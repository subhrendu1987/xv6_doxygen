\hypertarget{sysproc_8c_source}{}\doxysection{sysproc.\+c}
\mbox{\hyperlink{sysproc_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{types_8h}{types.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00002}00002 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{x86_8h}{x86.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{defs_8h}{defs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{date_8h}{date.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00005}00005 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{param_8h}{param.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00006}00006 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{memlayout_8h}{memlayout.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00007}00007 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmu_8h}{mmu.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00008}00008 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{proc_8h}{proc.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00009}00009 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{uproc_8h}{uproc.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00010}00010 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{spinlock_8h}{spinlock.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00012}00012 \textcolor{keyword}{struct }\{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00013}\mbox{\hyperlink{sysproc_8c_ab28e82cd5dda7d960095706a3ea20572}{00013}}   \textcolor{keyword}{struct }\mbox{\hyperlink{structspinlock}{spinlock}} \mbox{\hyperlink{sysproc_8c_ab28e82cd5dda7d960095706a3ea20572}{lock}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00014}\mbox{\hyperlink{sysproc_8c_a5780b0050ca664736fd1cc9696624ce5}{00014}}   \textcolor{keyword}{struct }\mbox{\hyperlink{structproc}{proc}} \mbox{\hyperlink{structproc}{proc}}[\mbox{\hyperlink{param_8h_a810c5b751df5bb30588613ed91095129}{NPROC}}];}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00015}\mbox{\hyperlink{sysproc_8c_ae184b491d39d06a7ba30c72b18472ad3}{00015}} \} \mbox{\hyperlink{sysproc_8c_ae184b491d39d06a7ba30c72b18472ad3}{ptable}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00018}00018 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00019}\mbox{\hyperlink{syscall_8c_a3b05102e512b34446a54334f916ba5cd}{00019}} \mbox{\hyperlink{sysproc_8c_a3b05102e512b34446a54334f916ba5cd}{sys\_fork}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00020}00020 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00021}00021   \textcolor{keywordflow}{return} \mbox{\hyperlink{defs_8h_acd2e1ded4bb6fce4500438bf928330f4}{fork}}();}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00022}00022 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00024}00024 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00025}\mbox{\hyperlink{syscall_8c_aee72faa31a0c32b410aba558ef1d59f2}{00025}} \mbox{\hyperlink{sysproc_8c_aee72faa31a0c32b410aba558ef1d59f2}{sys\_exit}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00026}00026 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00027}00027   \mbox{\hyperlink{defs_8h_aaf98ef7cdde3a0dfb2e49919de3298b1}{exit}}();}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00028}00028   \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// not reached}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00029}00029 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00031}00031 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00032}\mbox{\hyperlink{syscall_8c_ad202e06addda05ba6fe60f05d3f61913}{00032}} \mbox{\hyperlink{sysproc_8c_ad202e06addda05ba6fe60f05d3f61913}{sys\_wait}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00033}00033 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00034}00034   \textcolor{keywordflow}{return} \mbox{\hyperlink{defs_8h_af6f31822f7e737b4e414bdac1ccb59a4}{wait}}();}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00035}00035 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00037}00037 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00038}\mbox{\hyperlink{syscall_8c_ad766b54842470b464a6497bb5c514e59}{00038}} \mbox{\hyperlink{sysproc_8c_ad766b54842470b464a6497bb5c514e59}{sys\_kill}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00039}00039 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00040}00040   \textcolor{keywordtype}{int} \mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00042}00042   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a75bc8d8c7ea0b4b39d4f470e18e0dba7}{argint}}(0, \&\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}}) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00043}00043     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00044}00044   \textcolor{keywordflow}{return} \mbox{\hyperlink{defs_8h_ab893e9671d6bfe2b2604002a50639f21}{kill}}(\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00045}00045 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00047}00047 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00048}\mbox{\hyperlink{syscall_8c_ac81965412a0725574b8c72afda11243e}{00048}} \mbox{\hyperlink{sysproc_8c_ac81965412a0725574b8c72afda11243e}{sys\_getpid}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00049}00049 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00050}00050   \textcolor{keywordflow}{return} \mbox{\hyperlink{defs_8h_a3d2327db1e34643f4a9e6a07c8cc62c6}{myproc}}()-\/>\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00051}00051 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00053}00053 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00054}\mbox{\hyperlink{syscall_8c_ab21d46be776cf6075a997af525a1a628}{00054}} \mbox{\hyperlink{sysproc_8c_ab21d46be776cf6075a997af525a1a628}{sys\_sbrk}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00055}00055 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00056}00056   \textcolor{keywordtype}{int} addr;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00057}00057   \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00059}00059   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a75bc8d8c7ea0b4b39d4f470e18e0dba7}{argint}}(0, \&n) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00060}00060     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00061}00061   addr = \mbox{\hyperlink{defs_8h_a3d2327db1e34643f4a9e6a07c8cc62c6}{myproc}}()-\/>\mbox{\hyperlink{structproc_a6e67042bb361124ff287af88efc33e00}{sz}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00062}00062   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_acb02e9289fb8a1017c3455b137a9bccd}{growproc}}(n) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00063}00063     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00064}00064   \textcolor{keywordflow}{return} addr;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00065}00065 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00067}00067 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00068}\mbox{\hyperlink{syscall_8c_a59778ec9bfa6b6f2100b43fbba000573}{00068}} \mbox{\hyperlink{sysproc_8c_a59778ec9bfa6b6f2100b43fbba000573}{sys\_sleep}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00069}00069 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00070}00070   \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00071}00071   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} ticks0;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00073}00073   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a75bc8d8c7ea0b4b39d4f470e18e0dba7}{argint}}(0, \&n) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00074}00074     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00075}00075   \mbox{\hyperlink{defs_8h_afe4ef8638f1ecb962a6e67fb086ee3b8}{acquire}}(\&\mbox{\hyperlink{defs_8h_a094a4703b62095e2fa469fab3ffea5c7}{tickslock}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00076}00076   ticks0 = \mbox{\hyperlink{defs_8h_a7fcd6915876e066781399d7b00f1b1f0}{ticks}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00077}00077   \textcolor{keywordflow}{while}(\mbox{\hyperlink{defs_8h_a7fcd6915876e066781399d7b00f1b1f0}{ticks}} -\/ ticks0 < n)\{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00078}00078     \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a3d2327db1e34643f4a9e6a07c8cc62c6}{myproc}}()-\/>\mbox{\hyperlink{structproc_afb4f94a3f4df9a835dbb41b0c26660a4}{killed}})\{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00079}00079       \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{defs_8h_a094a4703b62095e2fa469fab3ffea5c7}{tickslock}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00080}00080       \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00081}00081     \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00082}00082     \mbox{\hyperlink{defs_8h_aca4a88f06b3ebbcc04330f7ae06c8507}{sleep}}(\&\mbox{\hyperlink{defs_8h_a7fcd6915876e066781399d7b00f1b1f0}{ticks}}, \&\mbox{\hyperlink{defs_8h_a094a4703b62095e2fa469fab3ffea5c7}{tickslock}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00083}00083   \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00084}00084   \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{defs_8h_a094a4703b62095e2fa469fab3ffea5c7}{tickslock}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00085}00085   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00086}00086 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00088}00088 \textcolor{comment}{// return how many clock tick interrupts have occurred}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00089}00089 \textcolor{comment}{// since start.}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00090}00090 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00091}\mbox{\hyperlink{syscall_8c_aaf8553903ba8f2776247679d4db0d121}{00091}} \mbox{\hyperlink{sysproc_8c_aaf8553903ba8f2776247679d4db0d121}{sys\_uptime}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00092}00092 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00093}00093   \mbox{\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}} xticks;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00095}00095   \mbox{\hyperlink{defs_8h_afe4ef8638f1ecb962a6e67fb086ee3b8}{acquire}}(\&\mbox{\hyperlink{defs_8h_a094a4703b62095e2fa469fab3ffea5c7}{tickslock}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00096}00096   xticks = \mbox{\hyperlink{defs_8h_a7fcd6915876e066781399d7b00f1b1f0}{ticks}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00097}00097   \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{defs_8h_a094a4703b62095e2fa469fab3ffea5c7}{tickslock}});}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00098}00098   \textcolor{keywordflow}{return} xticks;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00099}00099 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00101}00101 \textcolor{comment}{/*int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00102}00102 \textcolor{comment}{sys\_halt(void)}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00103}00103 \textcolor{comment}{\{}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00104}00104 \textcolor{comment}{  char *p = "{}Shutdown"{};}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00105}00105 \textcolor{comment}{  for( ; *p; p++)}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00106}00106 \textcolor{comment}{    outw(0xB004, 0x2000);}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00107}00107 \textcolor{comment}{  return 0;}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00108}00108 \textcolor{comment}{\}*/}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00110}00110 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00111}\mbox{\hyperlink{syscall_8c_a05c333cee816dc0cb3bf7dbe435dfcef}{00111}} \mbox{\hyperlink{sysproc_8c_a05c333cee816dc0cb3bf7dbe435dfcef}{sys\_halt}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00112}00112 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00113}00113   outb(0xf4, 0x00);}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00114}00114   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00115}00115 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00116}00116 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00118}00118 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00119}\mbox{\hyperlink{syscall_8c_a9eeed93775248f221437260b177591b8}{00119}} \mbox{\hyperlink{sysproc_8c_a9eeed93775248f221437260b177591b8}{sys\_cps}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00120}00120 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00121}00121   \textcolor{keywordflow}{return} \mbox{\hyperlink{defs_8h_a1e777db371a84ab92eb05662e4fa12d4}{cps}}();}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00122}00122 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00124}00124 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00125}\mbox{\hyperlink{syscall_8c_abc90a5b53d06206904d099c62efc1696}{00125}} \mbox{\hyperlink{sysproc_8c_abc90a5b53d06206904d099c62efc1696}{sys\_chpr}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00126}00126 \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00127}00127   \textcolor{keywordtype}{int} \mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}}, pr;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00128}00128   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a75bc8d8c7ea0b4b39d4f470e18e0dba7}{argint}}(0, \&\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}}) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00129}00129     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00130}00130   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a75bc8d8c7ea0b4b39d4f470e18e0dba7}{argint}}(1, \&pr) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00131}00131     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00132}00132 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00133}00133   \textcolor{keywordflow}{return} \mbox{\hyperlink{defs_8h_a2ca17a3161c80e3e4894ec6a96e0a281}{chpr}}(\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}}, pr);}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00134}00134 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00136}00136 \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00137}\mbox{\hyperlink{syscall_8c_a65e52d7f297b2757ffbf46e4deccf188}{00137}} \mbox{\hyperlink{sysproc_8c_a65e52d7f297b2757ffbf46e4deccf188}{sys\_getprocs}}(\textcolor{keywordtype}{void})\{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00138}00138   \textcolor{comment}{// declare local variables for max uproc size, struct uproc, and counter}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00139}00139   \textcolor{keywordtype}{int} max;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00140}00140   \textcolor{keyword}{struct }\mbox{\hyperlink{structuproc}{uproc}} *p;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00141}00141   \textcolor{keywordtype}{int} i=0;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00143}00143   \textcolor{comment}{// if argint has trouble, return error -\/1}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00144}00144   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a75bc8d8c7ea0b4b39d4f470e18e0dba7}{argint}}(0,\&max) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00145}00145     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00147}00147   \textcolor{comment}{// if argptr for allocating struct size has trouble, return -\/1}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00148}00148   \textcolor{keywordflow}{if}(\mbox{\hyperlink{defs_8h_a05c7464938c27eb91540c06ec6137f26}{argptr}}(1,(\textcolor{keywordtype}{char}**)\&p, max*\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \mbox{\hyperlink{structuproc}{uproc}})) < 0)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00149}00149     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00151}00151   \textcolor{comment}{// create pointer to ptable processes}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00152}00152   \textcolor{keyword}{struct }\mbox{\hyperlink{structproc}{proc}} *ptr = \mbox{\hyperlink{sysproc_8c_ae184b491d39d06a7ba30c72b18472ad3}{ptable}}.proc;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00154}00154   \textcolor{comment}{// loop through ptable}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00155}00155   \textcolor{keywordflow}{for}(; ptr < \&\mbox{\hyperlink{sysproc_8c_ae184b491d39d06a7ba30c72b18472ad3}{ptable}}.proc[\mbox{\hyperlink{param_8h_a810c5b751df5bb30588613ed91095129}{NPROC}}]; ptr++)}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00156}00156   \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00157}00157     \textcolor{keywordflow}{if}(!(ptr-\/>\mbox{\hyperlink{structproc_a0f2fe91548a1382672ae26e29ca9e736}{state}} == \mbox{\hyperlink{proc_8h_aa1ced7d2b60040fded3fa873d0c03ba7aa09b651ef326a9d8efcee5cc5b720ab4}{UNUSED}}))}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00158}00158     \{}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00159}00159       \textcolor{comment}{// if the process in ptable is not UNUSED, assign pid, parent pid, and name to uproc}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00160}00160       p[i].\mbox{\hyperlink{structuproc_a179010a9b3cc6e4dfd1dfd8fc1a7dcb8}{pid}} = ptr-\/>\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00161}00161       p[i].\mbox{\hyperlink{structuproc_a5c3d7f113b62601c9f92c3fd1ff915a2}{ppid}} = ptr-\/>\mbox{\hyperlink{structproc_a14ea8849701ffafba4d142725de154d4}{parent}}-\/>\mbox{\hyperlink{structproc_acf2bdf54d1f957ccbcdc987007029944}{pid}};}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00162}00162       \mbox{\hyperlink{defs_8h_a66107cd2364627727a36cef6c773b39c}{strncpy}}(p[i].\mbox{\hyperlink{usertests_8c_aee754febd402311e2a552cb0d6ab6629}{name}}, ptr-\/>\mbox{\hyperlink{structproc_ac04af53e17d24b90c3cbfab56d658d62}{name}}, 16);}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00163}00163       \textcolor{comment}{// add 1 to the process counter}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00164}00164       i++;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00165}00165     \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00166}00166   \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00167}00167   }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00168}00168   \textcolor{comment}{// return the number of processes that are not UNUSED}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00169}00169   \textcolor{keywordflow}{return} i;}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00170}00170 \}}
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{sysproc_8c_source_l00173}00173 }

\end{DoxyCode}
